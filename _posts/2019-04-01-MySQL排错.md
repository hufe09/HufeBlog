---
layout: post
title: "MySQL排错"
subtitle: ''
author: "Hufe"
header-img: "img/post-bg-mysql.jpg"
header-mask: 0.3
tags:
  - MySQL
---

## 1. 导入数据表时，出现外键错误
错误信息：
`MySQL - Cannot add or update a child row: a foreign key constraint fails`

```
ERR] 1062 - Duplicate entry '1' for key 'PRIMARY'
[ERR] INSERT INTO `parchposey`.`region` (`id`, `name`) VALUES (1, 'Northeast'),(2, 'Midwest'),(3, 'Southeast'),(4, 'West')
[ERR] 1062 - Duplicate entry '1' for key 'PRIMARY'
```

## 解决方法：
- 我通过将以下代码添加到SQL代码的开头来解决了我的“ 外键约束失败 ”问题（这是用于将值导入表）
``` mysql
SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT;
SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS;
SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION;
SET NAMES utf8;
SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO';
SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0; 
```

- 然后将此代码添加到文件的末尾
``` mysql
SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT;
SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS;
SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION;
SET SQL_NOTES=@OLD_SQL_NOTES; 
```
